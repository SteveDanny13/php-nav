<?php
//function.php file -
/*
function countImages($directory) {
    $ignore = array('.', '..');
    $counter = 0;

    foreach (scandir($directory) as $file) {
        if (!in_array($file, $ignore)) {
            $counter++;
        }
    }

    return $counter;
} */

include 'function.php';

error_reporting(E_ERROR | E_PARSE);

$directory = 'gallery';
$files = array_diff(scandir($directory), array('.', '..'));

$url = "http://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";
$eurl = str_replace("http://*ur_directory*/gallery.php?", "", $url);
?>

<aside class="aside">
    <?php foreach ($files as $file): ?>
        <?php 
        $activeClass = ($eurl === $file) ? 'class="active"' : '';
        ?>
        <a href="gallery.php?<?= $file ?>" <?= $activeClass ?>><?= $file ?></a><br>
    <?php endforeach; ?>
</aside>

<main>
    <section>
        <?php
        $dirname = "gallery/$eurl";
        if (empty($eurl)) {
            echo "<p>Pick gallery.</p>";
        } elseif (is_dir($dirname)) {
            $fileCount = countImages($dirname);
            echo "<p>img count: $fileCount</p>";

            foreach (scandir($dirname) as $file) {
                if (!in_array($file, array('.', '..'))) {
                    echo "<img src='gallery/$eurl/$file' style='max-width: 200px; margin: 5px;'/><br>\n";
                }
            }
        } else {
            echo "<p>no files</p>";
        }
        ?>
    </section>
</main>

<?php include 'partials/footer.php'; ?>
